document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector("#select_category"),o=document.querySelector("#search_template"),e=document.querySelector(".search_favorite");function s(){var n=t.value,s=o.value.toLowerCase(),a=document.querySelectorAll("a.search_favorite.active").length,e=document.querySelectorAll(".ts-item:not(.ignore)"),c=0;e.forEach(function(e){var t,o=!0;n&&e.dataset.cat!=n&&(o=!1),s&&(e.dataset.title.toLowerCase().includes(s)||(o=!1)),a&&((t=e.querySelector(".favorite_icon"))&&(!t||e.querySelector(".favorite_icon").classList.contains("active"))||(o=!1)),o?(c++,e.style.display="block"):e.style.display="none"}),0<c?(document.querySelector(".ts-list").style.display="flex",document.querySelector(".ts-no-results").style.display="none"):(document.querySelector(".ts-list").style.display="none",document.querySelector(".ts-no-results").style.display="block")}o.addEventListener("keyup",function(){0<this.value.length&&this.value.length<3||s()}),t.addEventListener("change",function(){s()}),e.addEventListener("click",function(){e.classList.toggle("active"),s()}),document.querySelectorAll(".ts-item").forEach(function(e){e.addEventListener("click",function(e){var o,t,n;e.target.classList.contains("favorite_icon")&&(e.preventDefault(),t=e.target.closest(".ts-item").dataset.id,o=t,e=Joomla.getOptions("csrf.token"),t=Joomla.getOptions("system.paths").base,e="/index.php?option=com_rstbox&view=templates&format=json&layout=raw&task=favorites_toggle&template_id="+o+"&"+e+"=1",(n=new XMLHttpRequest).open("POST",t+e),n.onload=function(){var e,t;200<=n.status&&n.status<300&&(t=JSON.parse(n.response),e=Object.keys(t).includes(o),t=document.querySelector(".ts-item[data-id='"+o+"'] .favorite_icon"),e?t.classList.add("active"):(t.classList.remove("active"),document.querySelectorAll("a.search_favorite.active").length&&s()))},n.send())})}),null!==document.querySelector(".licenseInvalid")&&document.addEventListener("click",function(e){if(e.target.classList.contains("ts-preview"))return alert(Joomla.Text._("COM_ENGAGEBOX_GALLERY_DOWNLOAD_KEY")),e.preventDefault(),!1})});

